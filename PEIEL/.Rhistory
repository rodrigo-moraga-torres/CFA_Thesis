reliability_poly <- function(data, items){
dat <- data[, items, drop = FALSE] |>
mutate(across(everything(), coerce_numeric))
pc <- psych::polychoric(dat)$rho
om <- try(psych::omega(pc, nfactors = 1, plot = FALSE), silent = TRUE)
al <- try(psych::alpha(dat), silent = TRUE)
list(omega = om, alpha = al)
}
rel_PEIEL <- reliability_poly(df, it_PEIEL)
rel_EID   <- reliability_poly(df, it_EID)
rel_SWB   <- reliability_poly(df, it_SWB)
rel_MPERC <- reliability_poly(df, it_MERIT_PERC)
rel_MPRF  <- reliability_poly(df, it_MERIT_PREF)
rel_PEIEL <- reliability_poly(df, it_PEIEL)
rel_EID   <- reliability_poly(df, it_EID)
rel_SWB   <- reliability_poly(df, it_SWB)
rel_MPERC <- reliability_poly(df, it_MERIT_PERC)
rel_MPRF  <- reliability_poly(df, it_MERIT_PREF)
## Mira en consola, por ejemplo:
# rel_PEIEL$omega ; rel_PEIEL$alpha
## ================================
## 4) AFC (WLSMV, ordinal) con MERIT en 2 factores correlacionados
## ================================
# Construcción de bloques de medición (sintaxis lavaan)
paste_items <- function(v) paste(v, collapse = " + ")
model_cfa_2f_merit <- glue('
PEIEL =~ {paste_items(it_PEIEL)}
EID   =~ {paste_items(it_EID)}
SWB   =~ {paste_items(it_SWB)}
MERIT_PERC =~ {paste_items(it_MERIT_PERC)}
MERIT_PREF =~ {paste_items(it_MERIT_PREF)}
## Correlación permitida entre dimensiones de MERIT
MERIT_PERC ~~ MERIT_PREF
')
cat("\n===== MODELO CFA (2 factores para MERIT) =====\n")
cat(model_cfa_2f_merit, "\n")
# Datos ordinales para lavaan
all_items <- c(it_PEIEL, it_EID, it_SWB, it_MERIT_PERC, it_MERIT_PREF) |> unique()
df_ord   <- df |> mutate(across(all_of(all_items), coerce_numeric))
fit_cfa_merit2 <- cfa(model_cfa_2f_merit, data = df_ord,
ordered = all_items, estimator = "WLSMV", std.lv = TRUE)
summary(fit_cfa_merit2, fit.measures = TRUE, standardized = TRUE)
inspect(fit_cfa_merit2, "modindices", sort. = TRUE, minimum.value = 10)
library(openxlsx)
library(psych)
library(lavaan)
a<-read.xlxs("20250906_Análisis_preliminar")
a<-read.xlsx("20250906_Análisis_preliminar")
a<-read.xlsx("20250906_Análisis_preliminar.xlsx")
db<-read.xlsx("20250906_Análisis_preliminar.xlsx")
db<-read.xlsx("20250906_Análisis_preliminar.xlsx")
PEIEL<-subset(db, select=PEIEL_1:PEIEL_6)
alpha(PEIEL)
alpha(PEIEL)
library(openxlsx)
library(psych)
library(lavaan)
db<-read.xlsx("20250906_Análisis_preliminar.xlsx")
PEIEL<-subset(db, select=PEIEL_1:PEIEL_6)
#Análisis fatorial exploratorio
psych::describe(PEIEL)
corrgram::corrgram(PEIEL)
corrgram.bartlett(PEIEL)
cortest.bartlett(PEIEL)
KMO(PEIEL)
cortest.bartlett(PEIEL)
#p= o
library(paran)
paran::paran(PEIEL)
paran::paran(na.omit(PEIEL), iterations = 5000,centile = 95,cfa = T)
fa.1<-PEIEL, nfactors=1, fm="minres", rotate="oblimin"
fa.1<-fa(PEIEL, nfactors=1, fm="minres", rotate="oblimin")
fa.2<-fa(PEIEL, nfactors=2, fm="minres", rotate="oblimin")
library(cebn)
fa2xlsx(fa.1, fa.2, cut = 0.4, filename = "análisis.factorial.PEIEL")
fa2xlsx(fa.1, fa.2, cut = 0.4, filename = "análisis.factorial.PEIEL.xlsx")
fa.1B<-fa(PEIEL [-1], nfactors=1, fm="minres", rotate="oblimin")
fa2xlsx(fa.1B, fa.2B, cut = 0.4, filename = "análisis.factorial.PEIEL.b.xlsx")
fa.2B<-fa(PEIEL [-1], nfactors=2, fm="minres", rotate="oblimin")
fa2xlsx(fa.1B, fa.2B, cut = 0.4, filename = "análisis.factorial.PEIEL.b.xlsx")
#2. Análisis Factorial Confirmatorio
dt<-data.frame( lapply(PEIEL, as numeric)   )
#2. Análisis Factorial Confirmatorio
dt<-data.frame(lapply(PEIEL, as.numeric))
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
dt<-data.frame(lapply(PEIEL, as.numeric))
modelo.fa.1="
modelo.fa.1cfa=~ PEIEL_1 + PEIEL_2 + PEIEL_3 + PEIEL_4 + PEIEL_5 + PEIEL_6
"
modelo.fa.2="
accesobys=~ PEIEL_1 + PEIEL_2 + PEIEL_3
adversidadfinanciera=~ PEIEL_4 + PEIEL_5 + PEIEL_6
"
modelo.fa.1b="
accesobys=~ PEIEL_2 + PEIEL_3 + PEIEL_4 + PEIEL_5 + PEIEL_6
"
modelo.fa.2b="
accesobys=~ cf*PEIEL_2 + cf*PEIEL_3
adversidadfinanciera=~ PEIEL_4 + PEIEL_5 + PEIEL_6
"
modelo.fa.1="
modelo.fa.1cfa=~ PEIEL_1 + PEIEL_2 + PEIEL_3 + PEIEL_4 + PEIEL_5 + PEIEL_6
"
cfa.PEIEL.1.mlr<-cfa(modelo.fa.1, dt, estimator="mlr")
modelo.fa.1="
modelo.fa.1cfa=~ PEIEL_1 + PEIEL_2 + PEIEL_3 + PEIEL_4 + PEIEL_5 + PEIEL_6
"
cfa.PEIEL.1.mlr<-cfa(modelo.fa.1, dt, estimator="mlr")
summary(cfa.PEIEL.1.mlr)
modelo.fa.2="
accesobys=~ PEIEL_1 + PEIEL_2 + PEIEL_3
adversidadfinanciera=~ PEIEL_4 + PEIEL_5 + PEIEL_6
"
cfa.PEIEL.2.mlr<-cfa(modelo.fa.2, dt, estimator="mlr")
summary(cfa.PEIEL.2.mlr)
modelo.fa.1="
modelo.fa.1cfa=~ PEIEL_1 + PEIEL_2 + PEIEL_3 + PEIEL_4 + PEIEL_5 + PEIEL_6
"
cfa.PEIEL.1.mlr<-cfa(modelo.fa.1, dt, estimator="mlr")
summary(cfa.PEIEL.1.mlr)
fitMeasures(cfa.PEIEL.1.mlr)
“El modelo de un factor mostró cargas factoriales significativas en todos los ítems (λ = 1.10–1.42, p < .001). No obstante, el ajuste global fue insuficiente (χ²(9) = 224.81, p < .001), lo que sugiere que un modelo estrictamente unidimensional no representa de manera óptima la estructura de los datos. Estos resultados son consistentes con el análisis exploratorio, donde se identificó un factor general junto con evidencia de una subestructura de dos dimensiones (acceso a bienes y servicios y adversidad financiera).”
modelo.fa.1="
modelo.fa.1cfa=~ PEIEL_1 + PEIEL_2 + PEIEL_3 + PEIEL_4 + PEIEL_5 + PEIEL_6
"
cfa.PEIEL.1.mlr<-cfa(modelo.fa.1, dt, estimator="mlr")
summary(cfa.PEIEL.1.mlr)
fitMeasures(cfa.PEIEL.1.mlr)
#“El modelo de un factor mostró cargas factoriales significativas en todos los ítems (λ = 1.10–1.42, p < .001). No obstante, el ajuste global fue insuficiente (χ²(9) = 224.81, p < .001), lo que sugiere que un modelo estrictamente unidimensional no representa de manera óptima la estructura de los datos. Estos resultados son consistentes con el análisis exploratorio, donde se identificó un factor general junto con evidencia de una subestructura de dos dimensiones (acceso a bienes y servicios y adversidad financiera).”
modelo.fa.2="
accesobys=~ PEIEL_1 + PEIEL_2 + PEIEL_3
adversidadfinanciera=~ PEIEL_4 + PEIEL_5 + PEIEL_6
"
cfa.PEIEL.2.mlr<-cfa(modelo.fa.2, dt, estimator="mlr")
summary(cfa.PEIEL.2.mlr)
fitMeasures(cfa.PEIEL.2.mlr)
#“Se compararon dos modelos de análisis factorial confirmatorio para la escala PEIEL: un modelo unidimensional y uno bidimensional, compuesto por acceso a bienes/servicios (ítems 1–3) y adversidad financiera (ítems 4–6). El modelo unidimensional presentó un ajuste deficiente (χ²(9) = 224.81, p < .001), mientras que el modelo de dos factores correlacionados mostró un ajuste adecuado (χ²(8) = 12.32, p = .137; χ² escalado = 5.92, p = .656). Todas las cargas factoriales fueron significativas y elevadas (λ = 1.08–1.29, p < .001), y la covarianza entre los dos factores fue positiva y moderada (φ = .46, p < .001). Estos resultados respaldan que la escala PEIEL se organiza en dos dimensiones relacionadas, consistentes con estudios previos de validación.”
modelo.fa.1="
modelo.fa.1cfa=~ PEIEL_1 + PEIEL_2 + PEIEL_3 + PEIEL_4 + PEIEL_5 + PEIEL_6
"
cfa.PEIEL.1.mlr<-cfa(modelo.fa.1, dt, estimator="mlr")
summary(cfa.PEIEL.1.mlr)
fitMeasures(cfa.PEIEL.1.mlr)
#“El modelo de un factor mostró cargas factoriales significativas en todos los ítems (λ = 1.10–1.42, p < .001). No obstante, el ajuste global fue insuficiente (χ²(9) = 224.81, p < .001), lo que sugiere que un modelo estrictamente unidimensional no representa de manera óptima la estructura de los datos. Estos resultados son consistentes con el análisis exploratorio, donde se identificó un factor general junto con evidencia de una subestructura de dos dimensiones (acceso a bienes y servicios y adversidad financiera).”
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
db<-read.xlsx("20250906_Análisis_preliminar.xlsx")
PEIEL<-subset(db, select=PEIEL_1:PEIEL_6)
alpha(PEIEL)
psych::describe(PEIEL)
corrgram::corrgram(PEIEL)
cortest.bartlett(PEIEL)
KMO(PEIEL)
#“La adecuación muestral fue satisfactoria (KMO = 0.84), y el test de esfericidad de Bartlett indicó que la matriz de correlaciones era factorizable, χ²(15) = 1725.31, p < .001. Estos resultados respaldan la pertinencia de realizar análisis factoriales confirmatorios para evaluar la estructura latente de la escala PEIEL.”
paran::paran(na.omit(PEIEL), iterations = 5000,centile = 95,cfa = T)
fa.1<-fa(PEIEL, nfactors=1, fm="minres", rotate="oblimin")
fa.2<-fa(PEIEL, nfactors=2, fm="minres", rotate="oblimin")
fa2xlsx(fa.1, fa.2, cut = 0.4, filename = "análisis.factorial.PEIEL.xlsx")
#“El análisis factorial exploratorio con un factor mostró cargas factoriales entre .54 y .82, lo que respalda la presencia de un constructo general. No obstante, al explorar una solución de dos factores, los ítems se distribuyeron en dos bloques conceptualmente consistentes: PEIEL_5, PEIEL_6 y PEIEL_4 cargaron en el primer factor (adversidad financiera y recursos básicos), mientras que PEIEL_3, PEIEL_2 y PEIEL_1 lo hicieron en el segundo (acceso a bienes y servicios). Estas dos soluciones son consistentes con la estructura reportada en estudios previos, aunque en la presente muestra un único factor explica la mayor parte de la varianza, lo que respalda el uso de una puntuación global.”
dt<-data.frame(lapply(PEIEL, as.numeric))
modelo.fa.1="
modelo.fa.1cfa=~ PEIEL_1 + PEIEL_2 + PEIEL_3 + PEIEL_4 + PEIEL_5 + PEIEL_6
"
cfa.PEIEL.1.mlr<-cfa(modelo.fa.1, dt, estimator="mlr")
summary(cfa.PEIEL.1.mlr)
fitMeasures(cfa.PEIEL.1.mlr)
#“El modelo de un factor mostró cargas factoriales significativas en todos los ítems (λ = 1.10–1.42, p < .001). No obstante, el ajuste global fue insuficiente (χ²(9) = 224.81, p < .001), lo que sugiere que un modelo estrictamente unidimensional no representa de manera óptima la estructura de los datos. Estos resultados son consistentes con el análisis exploratorio, donde se identificó un factor general junto con evidencia de una subestructura de dos dimensiones (acceso a bienes y servicios y adversidad financiera).”
modelo.fa.2="
accesobys=~ PEIEL_1 + PEIEL_2 + PEIEL_3
adversidadfinanciera=~ PEIEL_4 + PEIEL_5 + PEIEL_6
"
cfa.PEIEL.2.mlr<-cfa(modelo.fa.2, dt, estimator="mlr")
summary(cfa.PEIEL.2.mlr)
fitMeasures(cfa.PEIEL.2.mlr)
#“Se evaluaron dos modelos confirmatorios para la escala PEIEL. En primer lugar, se ajustó un modelo unidimensional con los seis ítems, el cual mostró cargas factoriales significativas en todos los indicadores (λ = 1.10–1.42, p < .001). No obstante, el ajuste global fue insatisfactorio (χ²(9) = 224.81, p < .001; CFI = .875; TLI = .791; RMSEA = .207 [.184–.231]; SRMR = .073), lo que sugiere que la estructura estrictamente unidimensional no representa adecuadamente los datos. Posteriormente, se estimó un modelo de dos factores correlacionados, definidos como acceso a bienes/servicios (ítems 1–3) y adversidad financiera (ítems 4–6). Este modelo presentó un ajuste excelente (χ²(8) = 12.32, p = .137; CFI = .997; TLI = .995; RMSEA = .031 [.000–.063]; SRMR = .017), con cargas factoriales elevadas y significativas en todos los ítems (λ = 1.08–1.29, p < .001). La correlación entre los factores fue positiva y moderada (φ = .46, p < .001), indicando que ambas dimensiones comparten varianza pero no son redundantes. En conjunto, estos hallazgos respaldan que la escala PEIEL se organiza en dos dimensiones relacionadas, consistentes con la validación previa en población chilena.”
alpha(PEIEL)
library(psych)
itms <- paste0("PEIEL_", 1:6)
# 1) Matriz policórica
Rpoly <- psych::polychoric(PEIEL[, itms])$rho
# 2) Omega total (y también te da ω_hierarchical si aplicara)
omega_out <- psych::omega(Rpoly, n.obs = nrow(PEIEL), sl = FALSE)
# sl=FALSE para no forzar solución "Schmid-Leiman" si no quieres bifactor
omega_out$omega.tot   # ω total
omega_out$omega.h     # ω jerárquico (si procede)
library(semTools)
rel_tab <- semTools::reliability(cfa.PEIEL.2.mlr)
rel_tab
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
db<-read.xlsx("20250906_Análisis_preliminar.xlsx")
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
db<-read.xlsx("20250906_Análisis_preliminar.xlsx")
PEIEL<-subset(db, select=PEIEL_1:PEIEL_6)
psych::describe(PEIEL)
corrgram::corrgram(PEIEL)
cortest.bartlett(PEIEL)
KMO(PEIEL)
#“La adecuación muestral fue satisfactoria (KMO = 0.84), y el test de esfericidad de Bartlett indicó que la matriz de correlaciones era factorizable, χ²(15) = 1725.31, p < .001. Estos resultados respaldan la pertinencia de realizar análisis factoriales confirmatorios para evaluar la estructura latente de la escala PEIEL.”
paran::paran(na.omit(PEIEL), iterations = 5000,centile = 95,cfa = T)
fa.1<-fa(PEIEL, nfactors=1, fm="minres", rotate="oblimin")
fa.2<-fa(PEIEL, nfactors=2, fm="minres", rotate="oblimin")
fa2xlsx(fa.1, fa.2, cut = 0.4, filename = "análisis.factorial.PEIEL.xlsx")
#“El análisis factorial exploratorio con un factor mostró cargas factoriales entre .54 y .82, lo que respalda la presencia de un constructo general. No obstante, al explorar una solución de dos factores, los ítems se distribuyeron en dos bloques conceptualmente consistentes: PEIEL_5, PEIEL_6 y PEIEL_4 cargaron en el primer factor (adversidad financiera y recursos básicos), mientras que PEIEL_3, PEIEL_2 y PEIEL_1 lo hicieron en el segundo (acceso a bienes y servicios). Estas dos soluciones son consistentes con la estructura reportada en estudios previos, aunque en la presente muestra un único factor explica la mayor parte de la varianza, lo que respalda el uso de una puntuación global.”
dt<-data.frame(lapply(PEIEL, as.numeric))
modelo.fa.1="
modelo.fa.1cfa=~ PEIEL_1 + PEIEL_2 + PEIEL_3 + PEIEL_4 + PEIEL_5 + PEIEL_6
"
cfa.PEIEL.1.mlr<-cfa(modelo.fa.1, dt, estimator="mlr")
summary(cfa.PEIEL.1.mlr)
fitMeasures(cfa.PEIEL.1.mlr)
#“El modelo de un factor mostró cargas factoriales significativas en todos los ítems (λ = 1.10–1.42, p < .001). No obstante, el ajuste global fue insuficiente (χ²(9) = 224.81, p < .001), lo que sugiere que un modelo estrictamente unidimensional no representa de manera óptima la estructura de los datos. Estos resultados son consistentes con el análisis exploratorio, donde se identificó un factor general junto con evidencia de una subestructura de dos dimensiones (acceso a bienes y servicios y adversidad financiera).”
modelo.fa.2="
accesobys=~ PEIEL_1 + PEIEL_2 + PEIEL_3
adversidadfinanciera=~ PEIEL_4 + PEIEL_5 + PEIEL_6
"
cfa.PEIEL.2.mlr<-cfa(modelo.fa.2, dt, estimator="mlr")
summary(cfa.PEIEL.2.mlr)
fitMeasures(cfa.PEIEL.2.mlr)
#“Se evaluaron dos modelos confirmatorios para la escala PEIEL. En primer lugar, se ajustó un modelo unidimensional con los seis ítems, el cual mostró cargas factoriales significativas en todos los indicadores (λ = 1.10–1.42, p < .001). No obstante, el ajuste global fue insatisfactorio (χ²(9) = 224.81, p < .001; CFI = .875; TLI = .791; RMSEA = .207 [.184–.231]; SRMR = .073), lo que sugiere que la estructura estrictamente unidimensional no representa adecuadamente los datos. Posteriormente, se estimó un modelo de dos factores correlacionados, definidos como acceso a bienes/servicios (ítems 1–3) y adversidad financiera (ítems 4–6). Este modelo presentó un ajuste excelente (χ²(8) = 12.32, p = .137; CFI = .997; TLI = .995; RMSEA = .031 [.000–.063]; SRMR = .017), con cargas factoriales elevadas y significativas en todos los ítems (λ = 1.08–1.29, p < .001). La correlación entre los factores fue positiva y moderada (φ = .46, p < .001), indicando que ambas dimensiones comparten varianza pero no son redundantes. En conjunto, estos hallazgos respaldan que la escala PEIEL se organiza en dos dimensiones relacionadas, consistentes con la validación previa en población chilena.”
rel_tab <- semTools::reliability(cfa.PEIEL.2.mlr)
rel_tab
#“En cuanto a la fiabilidad, la subescala de acceso a bienes y servicios presentó índices adecuados (α = .78; ω = .79; AVE = .56), mientras que la subescala de adversidad financiera mostró una consistencia interna alta (α = .86; ω = .87; AVE = .68). Estos resultados respaldan que ambas dimensiones de la escala PEIEL cuentan con una fiabilidad suficiente para ser utilizadas en el modelo de investigación.”
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
db<-read.xlsx("20250906_Análisis_preliminar.xlsx")
PEIEL<-subset(db, select=PEIEL_1:PEIEL_6)
psych::describe(PEIEL)
corrgram::corrgram(PEIEL)
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
db<-read.xlsx("20250906_Análisis_preliminar.xlsx")
db<-read.xlsx("db_final.xlsx")
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
db<-read.xlsx("db_final.xlsx")
PEIEL<-subset(db, select=PEIEL_1:PEIEL_6)
psych::describe(PEIEL)
corrgram::corrgram(PEIEL)
cortest.bartlett(PEIEL)
KMO(PEIEL)
#
paran::paran(na.omit(PEIEL), iterations = 5000,centile = 95,cfa = T)
fa.2<-fa(PEIEL, nfactors=2, fm="minres", rotate="oblimin")
fa.2<-fa(PEIEL, nfactors=2, fm="minres", rotate="oblimin")
fa2xlsx(fa.2, cut = 0.4, filename = "análisis.factorial.PEIEL.xlsx")
#Para evaluar la factibilidad de realizar un análisis factorial confirmatorio (AFC) sobre la escala PEIEL se llevaron a cabo pruebas preliminares. El test de esfericidad de Bartlett resultó significativo, χ²(15) = 1958.59, p < .001, indicando que la matriz de correlaciones difiere significativamente de la identidad y, por tanto, es adecuada para la factorización. El índice KMO global fue de .85, lo cual se considera un valor meritorio, mientras que los índices de adecuación muestral por ítem oscilaron entre .80 y .92, todos por sobre el umbral recomendado de .60. Estos resultados evidencian que la matriz de datos es apropiada para un análisis factorial.
#Posteriormente, se llevó a cabo un análisis paralelo de Horn con 5000 iteraciones. Los resultados mostraron que los dos primeros eigenvalores ajustados fueron superiores al valor esperado por azar (λ₁ = 3.21; λ₂ = 0.30), sugiriendo la retención de dos factores. Este hallazgo es consistente con la estructura teórica propuesta para el PEIEL, en la cual se diferencian los ítems vinculados al acceso a bienes y servicios de aquellos que reflejan situaciones de adversidad financiera.
dt<-data.frame(lapply(PEIEL, as.numeric))
modelo.fa.2="
accesobys=~ PEIEL_1 + PEIEL_2 + PEIEL_3
adversidadfinanciera=~ PEIEL_4 + PEIEL_5 + PEIEL_6
"
cfa.PEIEL.2.mlr<-cfa(modelo.fa.2, dt, estimator="mlr")
summary(cfa.PEIEL.2.mlr)
fitMeasures(cfa.PEIEL.2.mlr)
rel_tab <- semTools::reliability(cfa.PEIEL.2.mlr)
rel_tab
#
dt<-data.frame(lapply(PEIEL, as.numeric))
modelo.fa.2="
accesobys=~ PEIEL_1 + PEIEL_2 + PEIEL_3
adversidadfinanciera=~ PEIEL_4 + PEIEL_5 + PEIEL_6
"
cfa.PEIEL.2.mlr<-cfa(modelo.fa.2, dt, estimator="mlr")
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
dt<-data.frame(lapply(PEIEL, as.numeric))
modelo.fa.2="
accesobys=~ PEIEL_1 + PEIEL_2 + PEIEL_3
adversidadfinanciera=~ PEIEL_4 + PEIEL_5 + PEIEL_6
"
cfa.PEIEL.2.mlr<-cfa(modelo.fa.2, dt, estimator="mlr")
summary(cfa.PEIEL.2.mlr)
fitMeasures(cfa.PEIEL.2.mlr)
#El análisis factorial confirmatorio de la escala PEIEL mostró un ajuste excelente del modelo de dos factores correlacionados (χ²(8) = 13.83, p = .09; CFI = 0.997; TLI = 0.994; RMSEA = 0.036, IC90% [0.000–0.067]; SRMR = 0.017). Los ítems cargaron de manera consistente en sus respectivas dimensiones, agrupándose PEIEL_1, PEIEL_2 y PEIEL_3 en el factor Acceso a bienes y servicios, y PEIEL_4, PEIEL_5 y PEIEL_6 en el factor Adversidad financiera. Ambos factores mostraron una correlación fuerte (r = 0.73, p < .001), lo que sugiere que, aunque están estrechamente vinculados, representan dimensiones conceptualmente diferenciadas.
rel_tab <- semTools::reliability(cfa.PEIEL.2.mlr)
rel_tab
#Los análisis de fiabilidad y validez convergente indicaron valores adecuados para ambas dimensiones de PEIEL. La subescala de Acceso a bienes y servicios alcanzó una buena consistencia interna (α = .82; ω = .83) y un AVE satisfactorio (.62), mientras que la subescala de Adversidad financiera obtuvo índices aún más altos (α = .88; ω = .88; AVE = .71). Estos resultados confirman la solidez psicométrica del instrumento, respaldando su estructura bidimensional y su validez para evaluar condiciones económicas desde la percepción individual.
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
db<-read.xlsx("db_final.xlsx")
PEIEL<-subset(db, select=PEIEL_1:PEIEL_6)
psych::describe(PEIEL)
corrgram::corrgram(PEIEL)
cortest.bartlett(PEIEL)
#La esfericidad de Bartlett resultó significativa (χ²(15) = 1970.89, p < .001), por lo que la matriz de correlaciones es factorizable.
KMO(PEIEL)
#La medida de adecuación muestral de Kaiser-Meyer-Olkin (KMO) fue excelente (KMO global = 0.85), con valores por ítem entre 0.80 y 0.92. Estos resultados indican que la matriz de correlaciones de la escala PEIEL es apropiada para la aplicación de análisis factoriales.
paran::paran(na.omit(PEIEL), iterations = 5000,centile = 95,cfa = T)
fa.2<-fa(PEIEL, nfactors=2, fm="minres", rotate="oblimin")
fa.2<-fa(PEIEL, nfactors=2, fm="minres", rotate="oblimin")
fa2xlsx(fa.2, cut = 0.4, filename = "análisis.factorial.PEIEL.xlsx")
#El análisis factorial exploratorio con rotación indicó la presencia de dos factores en la escala PEIEL. El primer factor agrupó los ítems 1, 2 y 3, mientras que el segundo factor reunió los ítems 4, 5 y 6. La mayoría de los ítems presentó cargas factoriales altas (> .60), destacando PEIEL_2 (.87) y PEIEL_5 (.98) como los más sólidos. El ítem PEIEL_4 mostró la carga más baja (.63), aunque se mantuvo dentro de niveles aceptables. Estos resultados sugieren que la escala se organiza en dos dimensiones diferenciadas, más que en una estructura unidimensional.
dt<-data.frame(lapply(PEIEL, as.numeric))
modelo.fa.2="
accesobys=~ PEIEL_1 + PEIEL_2 + PEIEL_3
adversidadfinanciera=~ PEIEL_4 + PEIEL_5 + PEIEL_6
"
cfa.PEIEL.2.mlr<-cfa(modelo.fa.2, dt, estimator="mlr")
summary(cfa.PEIEL.2.mlr)
fitMeasures(cfa.PEIEL.2.mlr)
#El análisis factorial confirmatorio de la escala PEIEL mostró un ajuste excelente del modelo de dos factores correlacionados (χ²(8) = 13.83, p = .09; CFI = 0.997; TLI = 0.994; RMSEA = 0.036, IC90% [0.000–0.067]; SRMR = 0.017). Los ítems cargaron de manera consistente en sus respectivas dimensiones, agrupándose PEIEL_1, PEIEL_2 y PEIEL_3 en el factor Acceso a bienes y servicios, y PEIEL_4, PEIEL_5 y PEIEL_6 en el factor Adversidad financiera. Ambos factores mostraron una correlación fuerte (r = 0.73, p < .001), lo que sugiere que, aunque están estrechamente vinculados, representan dimensiones conceptualmente diferenciadas.
modelo.fa.2="
accesobys=~ PEIEL_1 + PEIEL_2 + PEIEL_3
adversidadfinanciera=~ PEIEL_4 + PEIEL_5 + PEIEL_6
"
cfa.PEIEL.2.mlr<-cfa(modelo.fa.2, dt, estimator="mlr")
summary(cfa.PEIEL.2.mlr)
fitMeasures(cfa.PEIEL.2.mlr)
#
rel_tab <- semTools::reliability(cfa.PEIEL.2.mlr)
rel_tab
#
# Extraer las cargas factoriales estandarizadas (Std.all)
cargas_CFA_PEIEL <- standardizedSolution(cfa.PEIEL.2.mlr) %>%
filter(op == "=~") %>%
select(Factor = lhs, Ítem = rhs, Carga = est.std) %>%
mutate(Carga = round(Carga, 3))
library(dyplr)
library(dplyr)
# Extraer las cargas factoriales estandarizadas (Std.all)
cargas_CFA_PEIEL <- standardizedSolution(cfa.PEIEL.2.mlr) %>%
filter(op == "=~") %>%
select(Factor = lhs, Ítem = rhs, Carga = est.std) %>%
mutate(Carga = round(Carga, 3))
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
library(dplyr)
library(lavaan)
library(knitr)
# Extraer las cargas factoriales estandarizadas (Std.all)
cargas_CFA_PEIEL <- standardizedSolution(cfa.PEIEL.2.mlr) %>%
filter(op == "=~") %>%
select(Factor = lhs, Ítem = rhs, Carga = est.std) %>%
mutate(Carga = round(Carga, 3))
# Extraer las cargas factoriales estandarizadas (Std.all)
cargas_CFA_PEIEL <- standardizedSolution(cfa.PEIEL.2.mlr) %>%
filter(op == "=~") %>%
select(Factor = lhs, Ítem = rhs, Carga = est.std) %>%
mutate(Carga = round(Carga, 3))
# Extraer las cargas factoriales estandarizadas (Std.all)
cargas_CFA_PEIEL <- standardizedSolution(cfa.PEIEL.2.mlr) %>%
filter(op == "=~") %>%
rename(Factor = lhs,
Ítem = rhs,
Carga = est.std) %>%
select(Factor, Ítem, Carga) %>%
mutate(Carga = round(Carga, 3))
# Extraer las cargas factoriales estandarizadas (Std.all)
cargas_CFA_PEIEL <- standardizedSolution(cfa.PEIEL.2.mlr) %>%
filter(op == "=~") %>%
select(Factor = lhs, Ítem = rhs, Carga = est.std) %>%
mutate(Carga = round(Carga, 3))
res <- standardizedSolution(cfa.PEIEL.2.mlr)
cargas_CFA_PEIEL <- res[res$op == "=~", c("lhs", "rhs", "est.std")]
names(cargas_CFA_PEIEL) <- c("Factor", "Ítem", "Carga")
cargas_CFA_PEIEL$Carga <- round(cargas_CFA_PEIEL$Carga, 3)
kable(cargas_CFA_PEIEL,
caption = "Tabla. Cargas factoriales estandarizadas del modelo confirmatorio de la escala PEIEL")
#Mostrar tabla
kable(cargas_CFA_PEIEL,
caption = "Tabla. Cargas factoriales estandarizadas de la escala PEIEL")
library(writexl)
write_xlsx(cargas_CFA_PEIEL, "cargas_CFA_PEIEL.xlsx")
# Extraer los principales índices de ajuste del modelo CFA
indices_PEIEL <- fitMeasures(cfa.PEIEL.2.mlr,
c("chisq.scaled", "df.scaled", "pvalue.scaled",
"cfi.robust", "tli.robust",
"rmsea.robust", "rmsea.ci.lower.robust",
"rmsea.ci.upper.robust", "srmr"))
# Crear tabla legible
tabla_indices_PEIEL <- data.frame(
Índice = c("χ² (gl)", "p", "CFI", "TLI", "RMSEA [IC90%]", "SRMR"),
Valor = c(
paste0(round(indices_PEIEL["chisq.scaled"],2), " (", indices_PEIEL["df.scaled"], ")"),
round(indices_PEIEL["pvalue.scaled"],3),
round(indices_PEIEL["cfi.robust"],3),
round(indices_PEIEL["tli.robust"],3),
paste0(round(indices_PEIEL["rmsea.robust"],3)," [",
round(indices_PEIEL["rmsea.ci.lower.robust"],3),"–",
round(indices_PEIEL["rmsea.ci.upper.robust"],3),"]"),
round(indices_PEIEL["srmr"],3)
)
)
#Exportar a Excel
write_xlsx(tabla_indices_PEIEL, "indices_ajuste_CFA_PEIEL.xlsx")
#Exportar a Excel
write_xlsx(tabla_indices_PEIEL, "indices_ajuste_PEIEL.xlsx")
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
library(dplyr)
library(lavaan)
library(knitr)
library(writexl)
#Exportar a Excel
write_xlsx(tabla_indices_PEIEL, "indices_ajuste_PEIEL.xlsx")
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
library(dplyr)
library(lavaan)
library(knitr)
library(writexl)
db<-read.xlsx("db_final.xlsx")
PEIEL<-subset(db, select=PEIEL_1:PEIEL_6)
psych::describe(PEIEL)
corrgram::corrgram(PEIEL)
cortest.bartlett(PEIEL)
#El test de esfericidad de Bartlett fue significativo, χ²(15) = 2510.19, p < .001, indicando que las correlaciones entre los ítems son adecuadas para realizar un análisis factorial.
KMO(PEIEL)
#El índice KMO fue de 0.84, lo que indica una adecuación muestral meritoria para realizar un análisis factorial. Todos los ítems presentaron valores individuales superiores a 0.80, evidenciando buena correlación común entre ellos.
paran::paran(na.omit(PEIEL), iterations = 5000,centile = 95,cfa = T)
fa.2<-fa(PEIEL, nfactors=2, fm="minres", rotate="oblimin")
fa2xlsx(fa.2, cut = 0.4, filename = "análisis.factorial.PEIEL.xlsx")
#El AFE confirma una estructura de dos factores claramente diferenciados y coherentes teóricamente, explicando adecuadamente la varianza de los ítems. Esto respalda la validez estructural de la escala PEIEL en tu muestra.
dt<-data.frame(lapply(PEIEL, as.numeric))
modelo.fa.2="
accesobys=~ PEIEL_1 + PEIEL_2 + PEIEL_3
adversidadfinanciera=~ PEIEL_4 + PEIEL_5 + PEIEL_6
"
cfa.PEIEL.2.mlr<-cfa(modelo.fa.2, dt, estimator="mlr")
summary(cfa.PEIEL.2.mlr)
fitMeasures(cfa.PEIEL.2.mlr)
#El análisis factorial confirmatorio del modelo bidimensional de la escala PEIEL mostró un ajuste excelente a los datos, χ²(8) = 15.36, p = .052, CFI = .995, TLI = .991, RMSEA = .045 [IC90% .00–.078], SRMR = .019. Todas las cargas factoriales fueron elevadas y significativas (p < .001), y los dos factores correlacionaron positivamente (r = .72, p < .001), confirmando una estructura de dos dimensiones interrelacionadas de desigualdad percibida: acceso a bienes y servicios y adversidad financiera.
rel_tab <- semTools::reliability(cfa.PEIEL.2.mlr)
rel_tab
#Los análisis de fiabilidad mostraron valores satisfactorios para ambas dimensiones de la escala PEIEL. La subescala Acceso a bienes y servicios presentó α = .83, ω = .83 y AVE = .63, mientras que la subescala Adversidad financiera alcanzó α = .87, ω = .88 y AVE = .70. Estos resultados indican una buena consistencia interna y validez convergente adecuada de ambas dimensiones.
#Extraer cargas factoriales
res <- standardizedSolution(cfa.PEIEL.2.mlr)
cargas_CFA_PEIEL <- res[res$op == "=~", c("lhs", "rhs", "est.std")]
names(cargas_CFA_PEIEL) <- c("Factor", "Ítem", "Carga")
cargas_CFA_PEIEL$Carga <- round(cargas_CFA_PEIEL$Carga, 3)
#Mostrar tabla
kable(cargas_CFA_PEIEL,
caption = "Tabla. Cargas factoriales estandarizadas de la escala PEIEL")
write_xlsx(cargas_CFA_PEIEL, "cargas_CFA_PEIEL.xlsx")
# Extraer los principales índices de ajuste del modelo CFA
indices_PEIEL <- fitMeasures(cfa.PEIEL.2.mlr,
c("chisq.scaled", "df.scaled", "pvalue.scaled",
"cfi.robust", "tli.robust",
"rmsea.robust", "rmsea.ci.lower.robust",
"rmsea.ci.upper.robust", "srmr"))
# Crear tabla legible
tabla_indices_PEIEL <- data.frame(
Índice = c("χ² (gl)", "p", "CFI", "TLI", "RMSEA [IC90%]", "SRMR"),
Valor = c(
paste0(round(indices_PEIEL["chisq.scaled"],2), " (", indices_PEIEL["df.scaled"], ")"),
round(indices_PEIEL["pvalue.scaled"],3),
round(indices_PEIEL["cfi.robust"],3),
round(indices_PEIEL["tli.robust"],3),
paste0(round(indices_PEIEL["rmsea.robust"],3)," [",
round(indices_PEIEL["rmsea.ci.lower.robust"],3),"–",
round(indices_PEIEL["rmsea.ci.upper.robust"],3),"]"),
round(indices_PEIEL["srmr"],3)
)
)
#Exportar a Excel
write_xlsx(tabla_indices_PEIEL, "indices_ajuste_PEIEL.xlsx")
