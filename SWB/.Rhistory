library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
db<-read.xlsx("20250906_Análisis_preliminar.xlsx")
SWB<-subset(db, select=SWB_1:SWB_5)
psych::describe(SWB)
corrgram::corrgram(SWB)
cortest.bartlett(PEIEL)
cortest.bartlett(SWB)
KMO(SWB)
#“La adecuación muestral fue satisfactoria (KMO = 0.84), y el test de esfericidad de Bartlett indicó que la matriz de correlaciones era factorizable, χ²(15) = 1725.31, p < .001. Estos resultados respaldan la pertinencia de realizar análisis factoriales confirmatorios para evaluar la estructura latente de la escala PEIEL.”
KMO(SWB)
#"La prueba de esfericidad de Bartlett resultó significativa (χ²(10) = 1334.37, p < .001) y el índice KMO global fue de .86, con valores individuales entre .82 y .91. Estos indicadores evidencian que la matriz de correlaciones de los ítems de Bienestar Subjetivo es altamente adecuada para realizar análisis factoriales.”
paran::paran(na.omit(SWB), iterations = 5000,centile = 95,cfa = T)
dt<-data.frame(lapply(SWB, as.numeric))
modelo.fa.1="
modelo.fa.1cfa=~ SWB_1 + SWB_2 + SWB_3 + SWB_4 + SWB_5
"
cfa.SWB.1.mlr<-cfa(modelo.fa.1, dt, estimator="mlr")
summary(cfa.SWB.1.mlr)
fitMeasures(cfa.SWB.1.mlr)
#“El modelo de un factor mostró cargas factoriales significativas en todos los ítems (λ = 1.10–1.42, p < .001). No obstante, el ajuste global fue insuficiente (χ²(9) = 224.81, p < .001), lo que sugiere que un modelo estrictamente unidimensional no representa de manera óptima la estructura de los datos. Estos resultados son consistentes con el análisis exploratorio, donde se identificó un factor general junto con evidencia de una subestructura de dos dimensiones (acceso a bienes y servicios y adversidad financiera).”
rel_tab <- semTools::reliability(cfa.SWB.1.mlr)
rel_tab
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
db<-read.xlsx("db_final.xlsx")
SWB<-subset(db, select=SWB_1:SWB_5)
psych::describe(SWB)
corrgram::corrgram(SWB)
cortest.bartlett(SWB)
#“La prueba de esfericidad de Bartlett resultó significativa (χ²(10) = 1334.37, p < .001), indicando que la matriz de correlaciones de los ítems de Bienestar Subjetivo es factorizable.”
KMO(SWB)
#
paran::paran(na.omit(SWB), iterations = 5000,centile = 95,cfa = T)
#“El análisis paralelo de Horn con 5000 simulaciones indicó la retención de un único factor (eigenvalue ajustado = 2.65), lo que respalda la unidimensionalidad de la escala de Bienestar Subjetivo en esta muestra.”
dt<-data.frame(lapply(SWB, as.numeric))
modelo.fa.1="
modelo.fa.1cfa=~ SWB_1 + SWB_2 + SWB_3 + SWB_4 + SWB_5
"
cfa.SWB.1.mlr<-cfa(modelo.fa.1, dt, estimator="mlr")
summary(cfa.SWB.1.mlr)
fitMeasures(cfa.SWB.1.mlr)
#“El modelo de un factor para la escala de Bienestar Subjetivo presentó un ajuste satisfactorio (χ²(5) = 15.33, p = .009; CFI = .992; TLI = .985; RMSEA = .061 [.028–.097]; SRMR = .019). Todas las cargas factoriales fueron significativas y de magnitud adecuada (λ estandarizados entre .60 y .80), lo que respalda la unidimensionalidad de la escala. Estos resultados indican que los cinco ítems reflejan coherentemente un único constructo de bienestar subjetivo.”
rel_tab <- semTools::reliability(cfa.SWB.1.mlr)
rel_tab
#
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
dt<-data.frame(lapply(SWB, as.numeric))
modelo.fa.1="
modelo.fa.1cfa=~ SWB_1 + SWB_2 + SWB_3 + SWB_4 + SWB_5
"
cfa.SWB.1.mlr<-cfa(modelo.fa.1, dt, estimator="mlr")
summary(cfa.SWB.1.mlr)
fitMeasures(cfa.SWB.1.mlr)
#El análisis factorial confirmatorio de la escala SWB respaldó su estructura unidimensional. El modelo presentó un ajuste adecuado (χ²(5) = 15.38, p = .009; CFI = 0.992; TLI = 0.984; RMSEA = 0.061, IC90% [0.028–0.096]; SRMR = 0.018). Todas las cargas factoriales fueron altas y significativas (0.84–1.12), indicando que los ítems contribuyen de manera consistente al factor latente. En conjunto, los resultados confirman la validez factorial de la escala de Bienestar Subjetivo.
rel_tab <- semTools::reliability(cfa.SWB.1.mlr)
rel_tab
#La escala SWB alcanzó una elevada consistencia interna (α = .87; ω = .87) y un índice de varianza extraída promedio satisfactorio (AVE = .58), lo que respalda su fiabilidad y validez convergente. Junto con los resultados del AFC, estos hallazgos confirman que la escala posee una estructura unidimensional sólida y es un instrumento válido y confiable para medir el bienestar subjetivo.
library(dplyr)
library(writexl)
db<-read.xlsx("db_final.xlsx")
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
library(dplyr)
library(writexl)
db<-read.xlsx("db_final.xlsx")
SWB<-subset(db, select=SWB_1:SWB_5)
SWB<-subset(db, select=SWB_1:SWB_5)
psych::describe(SWB)
corrgram::corrgram(SWB)
cortest.bartlett(SWB)
#La prueba de esfericidad de Bartlett fue significativa (χ²(10) = 1338.35, p < .001), lo que confirma que la matriz de correlaciones es factorizable y apropiada para realizar análisis factoriales.
KMO(SWB)
#La medida de adecuación muestral de Kaiser-Meyer-Olkin (KMO) fue excelente (KMO global = 0.86), con valores por ítem entre 0.82 y 0.91. Estos resultados indican que la matriz de correlaciones de la escala SWB es adecuada para la aplicación de análisis factoriales.
paran::paran(na.omit(SWB), iterations = 5000,centile = 95,cfa = T)
#“El análisis paralelo de Horn con 5000 simulaciones indicó la retención de un único factor (eigenvalue ajustado = 2.64), lo que respalda la unidimensionalidad de la escala de Bienestar Subjetivo en esta muestra.”
dt<-data.frame(lapply(SWB, as.numeric))
modelo.fa.1="
modelo.fa.1cfa=~ SWB_1 + SWB_2 + SWB_3 + SWB_4 + SWB_5
"
cfa.SWB.1.mlr<-cfa(modelo.fa.1, dt, estimator="mlr")
summary(cfa.SWB.1.mlr)
fitMeasures(cfa.SWB.1.mlr)
#El análisis factorial confirmatorio de la escala SWB respaldó su estructura unidimensional. El modelo presentó un ajuste adecuado (χ²(5) = 15.38, p = .009; CFI = 0.992; TLI = 0.984; RMSEA = 0.061, IC90% [0.028–0.096]; SRMR = 0.018). Todas las cargas factoriales fueron altas y significativas (0.84–1.12), indicando que los ítems contribuyen de manera consistente al factor latente. En conjunto, los resultados confirman la validez factorial de la escala de Bienestar Subjetivo.
rel_tab <- semTools::reliability(cfa.SWB.1.mlr)
rel_tab
#La escala SWB alcanzó una elevada consistencia interna (α = .87; ω = .87) y un índice de varianza extraída promedio satisfactorio (AVE = .58), lo que respalda su fiabilidad y validez convergente. Junto con los resultados del AFC, estos hallazgos confirman que la escala posee una estructura unidimensional sólida y es un instrumento válido y confiable para medir el bienestar subjetivo.
# Extraer las cargas factoriales estandarizadas
res_swb <- standardizedSolution(cfa.SWB.1.mlr)
# Filtrar las relaciones de carga (=~)
cargas_CFA_SWB <- res_swb[res_swb$op == "=~", c("rhs", "est.std")]
names(cargas_CFA_SWB) <- c("Ítem", "Carga")
# Redondear valores
cargas_CFA_SWB$Carga <- round(cargas_CFA_SWB$Carga, 3)
# Exportar a Excel
write_xlsx(cargas_CFA_SWB, "cargas_CFA_SWB.xlsx")
# Extraer principales índices de ajuste
indices_SWB <- fitMeasures(cfa.SWB.1.mlr,
c("chisq.scaled","df.scaled","pvalue.scaled",
"cfi.robust","tli.robust",
"rmsea.robust","rmsea.ci.lower.robust",
"rmsea.ci.upper.robust","srmr"))
# Crear tabla formateada
tabla_indices_SWB <- data.frame(
Índice = c("χ² (gl)", "p", "CFI", "TLI", "RMSEA [IC90%]", "SRMR"),
Valor = c(
paste0(round(indices_SWB["chisq.scaled"],2), " (", indices_SWB["df.scaled"], ")"),
round(indices_SWB["pvalue.scaled"],3),
round(indices_SWB["cfi.robust"],3),
round(indices_SWB["tli.robust"],3),
paste0(round(indices_SWB["rmsea.robust"],3)," [",
round(indices_SWB["rmsea.ci.lower.robust"],3),"–",
round(indices_SWB["rmsea.ci.upper.robust"],3),"]"),
round(indices_SWB["srmr"],3)
)
)
# Exportar a Excel
write_xlsx(tabla_indices_SWB, "indices_ajuste_CFA_SWB.xlsx")
