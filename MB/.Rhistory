library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
db<-read.xlsx("db_final.xlsx")
MB<-subset(db, select=MERIT_PERC_1:MERIT_PREF_4)
psych::describe(MB)
corrgram::corrgram(MB)
corrgram::corrgram(db)
corrgram::corrgram(MB)
cortest.bartlett(MB)
#“La prueba de esfericidad de Bartlett resultó significativa (χ²(28) = 1283.38, p < .001), lo que confirma que la matriz de correlaciones de los ítems de creencias meritocráticas es factorizable.”
KMO(db)
KMO(MB)
#
paran::paran(na.omit(MB), iterations = 5000,centile = 95,cfa = T)
fa.4<-fa(MB, nfactors=4, fm="minres", rotate="oblimin")
fa.4<-fa(MB, nfactors=4, fm="minres", rotate="oblimin")
fa2xlsx(fa.4, cut = 0.4, filename = "análisis.factorial.PEIEL.xlsx")
#
dt<-data.frame(lapply(MB, as.numeric))
modelo.fa.4="
MERIT_PREF_NEGAT=~ MERIT_PREF_3 + MERIT_PREF_4
MERIT_PERC_POSIT=~ MERIT_PERC_1 + MERIT_PERC_2
MERIT_PERC_NEGAT=~ MERIT_PERC_3 + MERIT_PERC_4
MERIT_PREF_POSIT=~ MERIT_PREF_2 + MERIT_PREF_1
"
cfa.MB.4.mlr<-cfa(modelo.fa.4, dt, estimator="mlr")
summary(cfa.MB.4.mlr)
fitMeasures(cfa.MB.4.mlr)
#“El análisis factorial confirmatorio de cuatro factores correlacionados mostró un ajuste excelente (χ²(14) = 11.99, p = .61; CFI = 1.00; TLI = 1.00; RMSEA = .000 [.000–.035]; SRMR = .015). Los ítems se agruparon de manera clara en percepciones pro-meritocráticas (PERC_1, PERC_2), percepciones anti-meritocráticas (PERC_3, PERC_4), preferencias anti-meritocráticas (PREF_3, PREF_4) y preferencias pro-meritocráticas (PREF_1, PREF_2). Todas las cargas factoriales fueron significativas, aunque el ítem PREF_1 presentó una saturación baja (λ ≈ .39), lo que lo convierte en el indicador más débil de su dimensión. Estos hallazgos sugieren que la escala no es unidimensional, sino que refleja cuatro facetas diferenciadas de las creencias meritocráticas.”
rel_tab <- semTools::reliability(cfa.MB.4.mlr)
rel_tab
#En términos de consistencia interna, las subescalas de percepciones pro-meritocráticas (α = .84, ω = .84; AVE = .72), percepciones anti-meritocráticas (α = .75, ω = .77; AVE = .63) y preferencias anti-meritocráticas (α = .83, ω = .84; AVE = .72) mostraron una adecuada fiabilidad. En contraste, la subescala de preferencias pro-meritocráticas presentó índices bajos (α = .57, ω = .58; AVE = .40), lo que indica una consistencia interna insuficiente, probablemente debido a la débil saturación del ítem PREF_1. En consecuencia, se recomienda interpretar esta dimensión con cautela
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
dt<-data.frame(lapply(MB, as.numeric))
modelo.fa.4="
MERIT_PREF_NEGAT=~ MERIT_PREF_3 + MERIT_PREF_4
MERIT_PERC_POSIT=~ MERIT_PERC_1 + MERIT_PERC_2
MERIT_PERC_NEGAT=~ MERIT_PERC_3 + MERIT_PERC_4
MERIT_PREF_POSIT=~ MERIT_PREF_2 + MERIT_PREF_1
"
cfa.MB.4.mlr<-cfa(modelo.fa.4, dt, estimator="mlr")
summary(cfa.MB.4.mlr)
fitMeasures(cfa.MB.4.mlr)
#El análisis factorial confirmatorio de cuatro factores mostró un ajuste excelente a los datos (χ²(14) = 11.75, p = .63; CFI = 1.00; TLI = 1.00; RMSEA = 0.000; SRMR = 0.015). Los ítems cargaron de manera adecuada en sus respectivas dimensiones, confirmando la distinción entre percepciones y preferencias meritocráticas y no meritocráticas. La única excepción fue MERIT_PREF_1, cuya carga factorial resultó débil y marginalmente significativa (p = .050). Las covarianzas entre factores reflejaron asociaciones conceptualmente coherentes, destacando la relación negativa entre preferencias no meritocráticas y percepciones meritocráticas (r = –.26, p < .001). En conjunto, los resultados respaldan la validez factorial del modelo de cuatro dimensiones, aunque sugieren la necesidad de revisar el ítem MERIT_PREF_1.
rel_tab <- semTools::reliability(cfa.MB.4.mlr)
rel_tab
#En términos de consistencia interna, las subescalas de percepciones pro-meritocráticas (α = .83, ω = .84; AVE = .72), percepciones anti-meritocráticas (α = .75, ω = .77; AVE = .63) y preferencias anti-meritocráticas (α = .83, ω = .84; AVE = .72) mostraron una adecuada fiabilidad. En contraste, la subescala de preferencias pro-meritocráticas presentó índices bajos (α = .57, ω = .58; AVE = .40), lo que indica una consistencia interna insuficiente, probablemente debido a la débil saturación del ítem PREF_1. En consecuencia, se recomienda interpretar esta dimensión con cautela
#Definifir el modelo 4 factores
modelo.fa.4="
MERIT_PREF_NEGAT=~ MERIT_PREF_3 + MERIT_PREF_4
MERIT_PERC_POSIT=~ MERIT_PERC_1 + MERIT_PERC_2
MERIT_PERC_NEGAT=~ MERIT_PERC_3 + MERIT_PERC_4
MERIT_PREF_POSIT=~ MERIT_PREF_2 + MERIT_PREF_1
"
#Ajuste del modelo: cfa->especificación modelo ->base datos ->máxima veros robusta (recomendado)
cfa.MB.4.mlr<-cfa(modelo.fa.4, dt, estimator="mlr")
summary(cfa.MB.4.mlr)
fitMeasures(cfa.MB.4.mlr)
#El análisis factorial confirmatorio de cuatro factores mostró un ajuste excelente a los datos (χ²(14) = 11.75, p = .63; CFI = 1.00; TLI = 1.00; RMSEA = 0.000; SRMR = 0.015). Los ítems cargaron de manera adecuada en sus respectivas dimensiones, confirmando la distinción entre percepciones y preferencias meritocráticas y no meritocráticas. La única excepción fue MERIT_PREF_1, cuya carga factorial resultó débil y marginalmente significativa (p = .050). Las covarianzas entre factores reflejaron asociaciones conceptualmente coherentes, destacando la relación negativa entre preferencias no meritocráticas y percepciones meritocráticas (r = –.26, p < .001). En conjunto, los resultados respaldan la validez factorial del modelo de cuatro dimensiones, aunque sugieren la necesidad de revisar el ítem MERIT_PREF_1.
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
db<-read.xlsx("db_final.xlsx")
paran::paran(na.omit(MB), iterations = 5000,centile = 95,cfa = T)
#El análisis paralelo de Horn, realizado con 5000 iteraciones y criterio del percentil 95, indicó la retención de cuatro factores (λ₁ajustado = 1.65; λ₂ajustado = 0.91; λ₃ajustado = 0.55; λ₄ajustado = 0.37). Este resultado sugiere que la escala no es unidimensional, sino que se organiza en cuatro dimensiones latentes.
fa.4<-fa(MB, nfactors=4, fm="gls", rotate="oblimin")
fa.3<-fa(MB, nfactors=3, fm="gls", rotate="oblimin")
fa2xlsx(fa.3, fa.4, cut = 0.4, filename = "análisis.factorial.PEIEL.xlsx")
#En el análisis factorial, todos los ítems se agruparon de manera consistente en las cuatro dimensiones teóricas, con excepción de MERIT_PREF_1, que no presentó cargas factoriales claras en ninguno de los factores. Su índice de representación fue bajo (≈ .26), lo que indica que este ítem no se asocia de forma significativa con la dimensión de preferencias meritocráticas ni con las demás. En consecuencia, se considera que MERIT_PREF_1 queda fuera de la estructura factorial, constituyendo un ítem débil que, si bien puede mantenerse por razones de validez de contenido, no aporta evidencia empírica sólida en la configuración del constructo.
#Definifir el modelo 4 factores
modelo.fa.4="
MERIT_PREF_NEGAT=~ 1*MERIT_PREF_3 + 1*MERIT_PREF_4
MERIT_PERC_POSIT=~ 1*MERIT_PERC_1 + 1*MERIT_PERC_2
MERIT_PERC_NEGAT=~ 1*MERIT_PERC_3 + 1*MERIT_PERC_4
MERIT_PREF_POSIT=~ 1*MERIT_PREF_2 + 1*MERIT_PREF_1
"
#Ajuste del modelo: cfa->especificación modelo ->base datos ->máxima veros robusta (recomendado)
cfa.MB.4.mlr<-cfa(modelo.fa.4, dt, estimator="mlr")
summary(cfa.MB.4.mlr)
fitMeasures(cfa.MB.4.mlr)
#El análisis factorial confirmatorio de cuatro factores mostró un ajuste excelente a los datos (χ²(14) = 11.75, p = .63; CFI = 1.00; TLI = 1.00; RMSEA = 0.000; SRMR = 0.015). Los ítems cargaron de manera adecuada en sus respectivas dimensiones, confirmando la distinción entre percepciones y preferencias meritocráticas y no meritocráticas. La única excepción fue MERIT_PREF_1, cuya carga factorial resultó débil y marginalmente significativa (p = .050). Las covarianzas entre factores reflejaron asociaciones conceptualmente coherentes, destacando la relación negativa entre preferencias no meritocráticas y percepciones meritocráticas (r = –.26, p < .001). En conjunto, los resultados respaldan la validez factorial del modelo de cuatro dimensiones, aunque sugieren la necesidad de revisar el ítem MERIT_PREF_1.
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
db<-read.xlsx("db_final.xlsx")
MB<-subset(db, select=MERIT_PERC_1:MERIT_PREF_4)
psych::describe(MB)
paran::paran(na.omit(MB), iterations = 5000,centile = 95,cfa = T)
#El análisis paralelo de Horn, realizado con 5000 iteraciones y criterio del percentil 95, indicó la retención de cuatro factores (λ₁ajustado = 1.65; λ₂ajustado = 0.91; λ₃ajustado = 0.55; λ₄ajustado = 0.37). Este resultado sugiere que la escala no es unidimensional, sino que se organiza en cuatro dimensiones latentes.
fa.4<-fa(MB, nfactors=4, fm="gls", rotate="oblimin")
fa.4<-fa(MB, nfactors=4, fm="gls", rotate="oblimin")
fa2xlsx(fa.3, fa.4, cut = 0.4, filename = "análisis.factorial.PEIEL.xlsx")
#En el análisis factorial, todos los ítems se agruparon de manera consistente en las cuatro dimensiones teóricas, con excepción de MERIT_PREF_1, que no presentó cargas factoriales claras en ninguno de los factores. Su índice de representación fue bajo (≈ .26), lo que indica que este ítem no se asocia de forma significativa con la dimensión de preferencias meritocráticas ni con las demás. En consecuencia, se considera que MERIT_PREF_1 queda fuera de la estructura factorial, constituyendo un ítem débil que, si bien puede mantenerse por razones de validez de contenido, no aporta evidencia empírica sólida en la configuración del constructo.
fa2xlsx(fa.3, fa.4, cut = 0.4, filename = "análisis.factorial.MERIT.xlsx")
#En el análisis factorial, todos los ítems se agruparon de manera consistente en las cuatro dimensiones teóricas, con excepción de MERIT_PREF_1, que no presentó cargas factoriales claras en ninguno de los factores. Su índice de representación fue bajo (≈ .26), lo que indica que este ítem no se asocia de forma significativa con la dimensión de preferencias meritocráticas ni con las demás. En consecuencia, se considera que MERIT_PREF_1 queda fuera de la estructura factorial, constituyendo un ítem débil que, si bien puede mantenerse por razones de validez de contenido, no aporta evidencia empírica sólida en la configuración del constructo.
dt<-data.frame(lapply(MB, as.numeric))
#Definifir el modelo 4 factores
modelo.fa.4="
MERIT_PREF_NEGAT=~ 1*MERIT_PREF_3 + 1*MERIT_PREF_4
MERIT_PERC_POSIT=~ 1*MERIT_PERC_1 + 1*MERIT_PERC_2
MERIT_PERC_NEGAT=~ 1*MERIT_PERC_3 + 1*MERIT_PERC_4
MERIT_PREF_POSIT=~ 1*MERIT_PREF_2 + 1*MERIT_PREF_1
"
#Ajuste del modelo: cfa->especificación modelo ->base datos ->máxima veros robusta (recomendado)
cfa.MB.4.mlr<-cfa(modelo.fa.4, dt, estimator="mlr")
summary(cfa.MB.4.mlr)
fitMeasures(cfa.MB.4.mlr)
#El análisis factorial confirmatorio de cuatro factores mostró un ajuste excelente a los datos (χ²(14) = 11.75, p = .63; CFI = 1.00; TLI = 1.00; RMSEA = 0.000; SRMR = 0.015). Los ítems cargaron de manera adecuada en sus respectivas dimensiones, confirmando la distinción entre percepciones y preferencias meritocráticas y no meritocráticas. La única excepción fue MERIT_PREF_1, cuya carga factorial resultó débil y marginalmente significativa (p = .050). Las covarianzas entre factores reflejaron asociaciones conceptualmente coherentes, destacando la relación negativa entre preferencias no meritocráticas y percepciones meritocráticas (r = –.26, p < .001). En conjunto, los resultados respaldan la validez factorial del modelo de cuatro dimensiones, aunque sugieren la necesidad de revisar el ítem MERIT_PREF_1.
#Definifir el modelo 4 factores
modelo.fa.4="
MERIT_PREF_NEGAT=~ 1*MERIT_PREF_3 + 1*MERIT_PREF_4
MERIT_PERC_POSIT=~ 1*MERIT_PERC_1 + 1*MERIT_PERC_2
MERIT_PERC_NEGAT=~ 1*MERIT_PERC_3 + 1*MERIT_PERC_4
MERIT_PREF_POSIT=~ 1*MERIT_PREF_2 + 1*MERIT_PREF_1
"
#Ajuste del modelo: cfa->especificación modelo ->base datos ->máxima veros robusta (recomendado)
cfa.MB.4.mlr<-cfa(modelo.fa.4, dt, estimator="mlr")
summary(cfa.MB.4.mlr)
fitMeasures(cfa.MB.4.mlr)
#
dt<-data.frame(lapply(MB, as.numeric))
dt<-data.frame(lapply(MB, as.numeric))
rel_tab <- semTools::reliability(cfa.MB.4.mlr)
rel_tab
#En términos de consistencia interna, las subescalas de percepciones pro-meritocráticas (α = .83, ω = .84; AVE = .72), percepciones anti-meritocráticas (α = .75, ω = .77; AVE = .63) y preferencias anti-meritocráticas (α = .83, ω = .84; AVE = .72) mostraron una adecuada fiabilidad. En contraste, la subescala de preferencias pro-meritocráticas presentó índices bajos (α = .57, ω = .58; AVE = .40), lo que indica una consistencia interna insuficiente, probablemente debido a la débil saturación del ítem PREF_1. En consecuencia, se recomienda interpretar esta dimensión con cautela
rel_tab <- semTools::reliability(modelo.fa.4)
fa.4<-fa(MB, nfactors=4, fm="gls", rotate="oblimin")
fa2xlsx(fa.3, fa.4, cut = 0.4, filename = "análisis.factorial.MERIT.xlsx")
#En el análisis factorial, todos los ítems se agruparon de manera consistente en las cuatro dimensiones teóricas, con excepción de MERIT_PREF_1, que no presentó cargas factoriales claras en ninguno de los factores. Su índice de representación fue bajo (≈ .26), lo que indica que este ítem no se asocia de forma significativa con la dimensión de preferencias meritocráticas ni con las demás. En consecuencia, se considera que MERIT_PREF_1 queda fuera de la estructura factorial, constituyendo un ítem débil que, si bien puede mantenerse por razones de validez de contenido, no aporta evidencia empírica sólida en la configuración del constructo.
rel_tab <- semTools::reliability(cfa.MB.4.mlr)
rel_tab
#En términos de consistencia interna, las subescalas de percepciones pro-meritocráticas (α = .83, ω = .84; AVE = .72), percepciones anti-meritocráticas (α = .75, ω = .77; AVE = .63) y preferencias anti-meritocráticas (α = .83, ω = .84; AVE = .72) mostraron una adecuada fiabilidad. En contraste, la subescala de preferencias pro-meritocráticas presentó índices bajos (α = .57, ω = .58; AVE = .40), lo que indica una consistencia interna insuficiente, probablemente debido a la débil saturación del ítem PREF_1. En consecuencia, se recomienda interpretar esta dimensión con cautela
library(lavaan)
library(dplyr)
library(stringr)
# 1) Cargas estandarizadas y p-values
pe <- parameterEstimates(cfa.MB.4.mlr, standardized = TRUE)
loads <- pe %>%
filter(op == "=~") %>%                         # solo cargas
transmute(
Factor = lhs,
Item   = rhs,
lambda = std.all,                            # carga estandarizada
p      = pvalue
)
# 2) θ (varianzas residuales estandarizadas) y R2 por ítem
theta_std <- lavInspect(cfa.MB.4.mlr, "std")$theta   # matriz Theta estandarizada
theta_df  <- tibble(
Item  = colnames(theta_std),
theta = diag(theta_std)
)
r2_vec <- lavInspect(cfa.MB.4.mlr, "r2")             # vector R2 por ítem
r2_df  <- tibble(Item = names(r2_vec), R2 = as.numeric(r2_vec))
# 3) Unir todo y ordenar
orden_items <- c("MERIT_PREF_1","MERIT_PREF_2","MERIT_PREF_3","MERIT_PREF_4",
"MERIT_PERC_1","MERIT_PERC_2","MERIT_PERC_3","MERIT_PERC_4")
tabla_merit <- loads %>%
left_join(theta_df, by = "Item") %>%
left_join(r2_df,    by = "Item") %>%
mutate(p = ifelse(p < .001, "< .001", sprintf("= %.3f", p))) %>%
mutate(Item = factor(Item, levels = orden_items)) %>%
arrange(Item) %>%
mutate(
lambda = round(lambda, 3),
theta  = round(theta, 3),
R2     = round(R2, 3)
) %>%
select(Item, Factor, `Carga (λ)` = lambda, `Error (θ)` = theta, `R²` = R2, p)
tabla_merit
# 1) Cargas estandarizadas y p-values
pe <- parameterEstimates(cfa.MB.4.mlr, standardized = TRUE)
loads <- pe %>%
filter(op == "=~") %>%                         # solo cargas
transmute(
Factor = lhs,
Item   = rhs,
lambda = std.all,                            # carga estandarizada
p      = pvalue
)
# 2) θ (varianzas residuales estandarizadas) y R2 por ítem
theta_std <- lavInspect(cfa.MB.4.mlr, "std")$theta   # matriz Theta estandarizada
theta_df  <- tibble(
Item  = colnames(theta_std),
theta = diag(theta_std)
)
r2_vec <- lavInspect(cfa.MB.4.mlr, "r2")             # vector R2 por ítem
r2_df  <- tibble(Item = names(r2_vec), R2 = as.numeric(r2_vec))
# 3) Unir todo y ordenar
orden_items <- c("MERIT_PREF_1","MERIT_PREF_2","MERIT_PREF_3","MERIT_PREF_4",
"MERIT_PERC_1","MERIT_PERC_2","MERIT_PERC_3","MERIT_PERC_4")
tabla_merit <- loads %>%
left_join(theta_df, by = "Item") %>%
left_join(r2_df,    by = "Item") %>%
mutate(p = ifelse(p < .001, "< .001", sprintf("= %.3f", p))) %>%
mutate(Item = factor(Item, levels = orden_items)) %>%
arrange(Item) %>%
mutate(
lambda = round(lambda, 3),
theta  = round(theta, 3),
R2     = round(R2, 3)
) %>%
select(Item, Factor, `Carga (λ)` = lambda, `Error (θ)` = theta, `R²` = R2, p)
tabla_merit
library(lavaan)
library(dplyr)
# --- 1) Cargas estandarizadas (λ) ---
std_loads <- standardizedSolution(cfa.MB.4.mlr) %>%
filter(op == "=~") %>%
transmute(Factor = lhs, Item = rhs, lambda_std = std.all)
dt<-data.frame(lapply(MB, as.numeric))
#Definifir el modelo 4 factores
modelo.fa.4="
MERIT_PREF_NEGAT=~ 1*MERIT_PREF_3 + 1*MERIT_PREF_4
MERIT_PERC_POSIT=~ 1*MERIT_PERC_1 + 1*MERIT_PERC_2
MERIT_PERC_NEGAT=~ 1*MERIT_PERC_3 + 1*MERIT_PERC_4
MERIT_PREF_POSIT=~ 1*MERIT_PREF_2 + 1*MERIT_PREF_1
"
#Ajuste del modelo: cfa->especificación modelo ->base datos ->máxima veros robusta (recomendado)
cfa.MB.4.mlr<-cfa(modelo.fa.4, dt, estimator="gls")
summary(cfa.MB.4.mlr)
fitMeasures(cfa.MB.4.mlr)
#
summary(cfa.MB.4.mlr)
#Definifir el modelo 4 factores
modelo.fa.4="
MERIT_PREF_NEGAT=~ 1*MERIT_PREF_3 + 1*MERIT_PREF_4
MERIT_PERC_POSIT=~ 1*MERIT_PERC_1 + 1*MERIT_PERC_2
MERIT_PERC_NEGAT=~ 1*MERIT_PERC_3 + 1*MERIT_PERC_4
MERIT_PREF_POSIT=~ 1*MERIT_PREF_2 + 1*MERIT_PREF_1
"
#Ajuste del modelo: cfa->especificación modelo ->base datos ->máxima veros robusta (recomendado)
cfa.MB.4.mlr<-cfa(modelo.fa.4, dt, estimator="gls")
summary(cfa.MB.4.mlr)
fitMeasures(cfa.MB.4.mlr)
#
summary(cfa.MB.4.mlr, standardized = TRUE)
rel_tab <- semTools::reliability(cfa.MB.4.mlr)
rel_tab
#En términos de consistencia interna, las subescalas de percepciones pro-meritocráticas (α = .83, ω = .84; AVE = .72), percepciones anti-meritocráticas (α = .75, ω = .77; AVE = .63) y preferencias anti-meritocráticas (α = .83, ω = .84; AVE = .72) mostraron una adecuada fiabilidad. En contraste, la subescala de preferencias pro-meritocráticas presentó índices bajos (α = .57, ω = .58; AVE = .40), lo que indica una consistencia interna insuficiente, probablemente debido a la débil saturación del ítem PREF_1. En consecuencia, se recomienda interpretar esta dimensión con cautela
dt<-data.frame(lapply(MB, as.numeric))
#Definifir el modelo 4 factores
modelo.fa.4="
MERIT_PREF_NEGAT=~ 1*MERIT_PREF_3 + 1*MERIT_PREF_4
MERIT_PERC_POSIT=~ 1*MERIT_PERC_1 + 1*MERIT_PERC_2
MERIT_PERC_NEGAT=~ 1*MERIT_PERC_3 + 1*MERIT_PERC_4
MERIT_PREF_POSIT=~ 1*MERIT_PREF_2 + 1*MERIT_PREF_1
"
#Ajuste del modelo: cfa->especificación modelo ->base datos ->máxima veros robusta (recomendado)
cfa.MB.4.mlr<-cfa(modelo.fa.4, dt, estimator="gls")
summary(cfa.MB.4.mlr, standardized = TRUE)
fitMeasures(cfa.MB.4.mlr)
#
dt<-data.frame(lapply(MB, as.numeric))
#Definifir el modelo 4 factores
modelo.fa.4="
MERIT_PREF_NEGAT=~ 1*MERIT_PREF_3 + 1*MERIT_PREF_4
MERIT_PERC_POSIT=~ 1*MERIT_PERC_1 + 1*MERIT_PERC_2
MERIT_PERC_NEGAT=~ 1*MERIT_PERC_3 + 1*MERIT_PERC_4
MERIT_PREF_POSIT=~ 1*MERIT_PREF_2 + 1*MERIT_PREF_1
"
#Ajuste del modelo: cfa->especificación modelo ->base datos ->máxima veros robusta (recomendado)
cfa.MB.4.mlr<-cfa(modelo.fa.4, dt, estimator="gls")
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
#Definifir el modelo 4 factores
modelo.fa.4="
MERIT_PREF_NEGAT=~ 1*MERIT_PREF_3 + 1*MERIT_PREF_4
MERIT_PERC_POSIT=~ 1*MERIT_PERC_1 + 1*MERIT_PERC_2
MERIT_PERC_NEGAT=~ 1*MERIT_PERC_3 + 1*MERIT_PERC_4
MERIT_PREF_POSIT=~ 1*MERIT_PREF_2 + 1*MERIT_PREF_1
"
#Ajuste del modelo: cfa->especificación modelo ->base datos ->máxima veros robusta (recomendado)
cfa.MB.4.mlr<-cfa(modelo.fa.4, dt, estimator="gls")
summary(cfa.MB.4.mlr, standardized = TRUE)
fitMeasures(cfa.MB.4.mlr)
#
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
library(dplyr)
library(knitr)
library()
db<-read.xlsx("db_final.xlsx")
MB<-subset(db, select=MERIT_PERC_1:MERIT_PREF_4)
psych::describe(MB)
corrgram::corrgram(MB)
cortest.bartlett(MB)
#La prueba de esfericidad de Bartlett resultó significativa (χ²(28) = 1284.35, p < .001), lo que confirma que la matriz de correlaciones de los ítems de percepción y preferencias meritocráticas es adecuada para la aplicación de análisis factoriales.
KMO(MB)
#
paran::paran(na.omit(MB), iterations = 5000,centile = 95,cfa = T)
#El análisis paralelo de Horn, realizado con 5000 iteraciones y criterio del percentil 95, indicó la retención de cuatro factores (λ₁ajustado = 1.65; λ₂ajustado = 0.91; λ₃ajustado = 0.55; λ₄ajustado = 0.37). Este resultado sugiere que la escala no es unidimensional, sino que se organiza en cuatro dimensiones latentes.
fa.4<-fa(MB, nfactors=4, fm="gls", rotate="oblimin")
fa.4<-fa(MB, nfactors=4, fm="gls", rotate="oblimin")
fa.3<-fa(MB, nfactors=3, fm="gls", rotate="oblimin")
fa2xlsx(fa.3, fa.4, cut = 0.4, filename = "análisis.factorial.MERIT.xlsx")
#En el análisis factorial, todos los ítems se agruparon de manera consistente en las cuatro dimensiones teóricas, con excepción de MERIT_PREF_1, que no presentó cargas factoriales claras en ninguno de los factores. Su índice de representación fue bajo (≈ .26), lo que indica que este ítem no se asocia de forma significativa con la dimensión de preferencias meritocráticas ni con las demás. En consecuencia, se considera que MERIT_PREF_1 queda fuera de la estructura factorial, constituyendo un ítem débil que, si bien puede mantenerse por razones de validez de contenido, no aporta evidencia empírica sólida en la configuración del constructo.
fa2xlsx(fa.3, fa.4, cut = 0.4, filename = "análisis.factorial.MERIT.xlsx")
#En el análisis factorial, todos los ítems se agruparon de manera consistente en las cuatro dimensiones teóricas, con excepción de MERIT_PREF_1, que no presentó cargas factoriales claras en ninguno de los factores. Su índice de representación fue bajo (≈ .26), lo que indica que este ítem no se asocia de forma significativa con la dimensión de preferencias meritocráticas ni con las demás. En consecuencia, se considera que MERIT_PREF_1 queda fuera de la estructura factorial, constituyendo un ítem débil que, si bien puede mantenerse por razones de validez de contenido, no aporta evidencia empírica sólida en la configuración del constructo.
dt<-data.frame(lapply(MB, as.numeric))
#Definifir el modelo 4 factores
modelo.fa.4="
MERIT_PREF_NEGAT=~ 1*MERIT_PREF_3 + 1*MERIT_PREF_4
MERIT_PERC_POSIT=~ 1*MERIT_PERC_1 + 1*MERIT_PERC_2
MERIT_PERC_NEGAT=~ 1*MERIT_PERC_3 + 1*MERIT_PERC_4
MERIT_PREF_POSIT=~ 1*MERIT_PREF_2 + 1*MERIT_PREF_1
"
#Ajuste del modelo: cfa->especificación modelo ->base datos ->máxima veros robusta (recomendado)
cfa.MB.4.mlr<-cfa(modelo.fa.4, dt, estimator="gls")
summary(cfa.MB.4.mlr, standardized = TRUE)
fitMeasures(cfa.MB.4.mlr)
#
rel_tab <- semTools::reliability(cfa.MB.4.mlr)
rel_tab
#En términos de consistencia interna, las subescalas de percepciones pro-meritocráticas (α = .83, ω = .84; AVE = .72), percepciones anti-meritocráticas (α = .75, ω = .77; AVE = .63) y preferencias anti-meritocráticas (α = .83, ω = .84; AVE = .72) mostraron una adecuada fiabilidad. En contraste, la subescala de preferencias pro-meritocráticas presentó índices bajos (α = .57, ω = .58; AVE = .40), lo que indica una consistencia interna insuficiente, probablemente debido a la débil saturación del ítem PREF_1. En consecuencia, se recomienda interpretar esta dimensión con cautela
# Extraer las cargas factoriales estandarizadas (Std.all)
res_merit <- standardizedSolution(cfa.MB.4.mlr)
# Filtrar solo las relaciones de carga (=~)
cargas_CFA_MERIT <- res_merit[res_merit$op == "=~", c("lhs", "rhs", "est.std")]
# Renombrar columnas
names(cargas_CFA_MERIT) <- c("Factor", "Ítem", "Carga")
# Redondear valores
cargas_CFA_MERIT$Carga <- round(cargas_CFA_MERIT$Carga, 3)
# 📂 Exportar a Excel
write_xlsx(cargas_CFA_MERIT, "cargas_MB.xlsx")
library(writexl)
# Extraer las cargas factoriales estandarizadas (Std.all)
res_merit <- standardizedSolution(cfa.MB.4.mlr)
# Filtrar solo las relaciones de carga (=~)
cargas_CFA_MERIT <- res_merit[res_merit$op == "=~", c("lhs", "rhs", "est.std")]
# Renombrar columnas
names(cargas_CFA_MERIT) <- c("Factor", "Ítem", "Carga")
# Redondear valores
cargas_CFA_MERIT$Carga <- round(cargas_CFA_MERIT$Carga, 3)
# 📂 Exportar a Excel
write_xlsx(cargas_CFA_MERIT, "cargas_MB.xlsx")
# Extraer las cargas factoriales estandarizadas (Std.all)
res_merit <- standardizedSolution(cfa.MB.4.mlr)
# Filtrar solo las relaciones de carga (=~)
cargas_CFA_MERIT <- res_merit[res_merit$op == "=~", c("lhs", "rhs", "est.std")]
# Renombrar columnas
names(cargas_CFA_MERIT) <- c("Factor", "Ítem", "Carga")
# Redondear valores
cargas_CFA_MERIT$Carga <- round(cargas_CFA_MERIT$Carga, 3)
# Exportar a Excel
write_xlsx(cargas_CFA_MERIT, "cargas_MB.xlsx")
# Extraer principales índices de ajuste del modelo CFA
indices_MERIT <- fitMeasures(cfa.MB.4.mlr,
c("chisq", "df", "pvalue",
"cfi", "tli",
"rmsea", "rmsea.ci.lower", "rmsea.ci.upper",
"srmr"))
# Crear tabla formateada
tabla_indices_MERIT <- data.frame(
Índice = c("χ² (gl)", "p", "CFI", "TLI", "RMSEA [IC90%]", "SRMR"),
Valor = c(
paste0(round(indices_MERIT["chisq"],2), " (", indices_MERIT["df"], ")"),
round(indices_MERIT["pvalue"],3),
round(indices_MERIT["cfi"],3),
round(indices_MERIT["tli"],3),
paste0(round(indices_MERIT["rmsea"],3)," [",
round(indices_MERIT["rmsea.ci.lower"],3),"–",
round(indices_MERIT["rmsea.ci.upper"],3),"]"),
round(indices_MERIT["srmr"],3)
)
)
# Exportar a Excel
write_xlsx(tabla_indices_MERIT, "indices_ajuste_MB.xlsx")
vIEW(db)
View(db)
psych::describe(MB)
corrgram::corrgram(MB)
#El test de esfericidad de Bartlett fue significativo, χ²(28) = 1612.96, p < .001, lo que indica que las correlaciones entre los ítems son adecuadas para realizar un análisis factorial.
```
cortest.bartlett(MB)
library(openxlsx)
library(psych)
library(lavaan)
library(paran)
library(cebn) #librería profesor Claudio Bustos
library(semTools)
library(dplyr)
library(knitr)
library(writexl)
cortest.bartlett(MB)
#El test de esfericidad de Bartlett fue significativo, χ²(28) = 1612.96, p < .001, lo que indica que las correlaciones entre los ítems son adecuadas para realizar un análisis factorial.
KMO(MB)
#El análisis paralelo de Horn indicó la retención de cuatro factores, ya que los valores propios ajustados (λ > 0) fueron positivos hasta el cuarto componente. Esto sugiere que el instrumento presenta una estructura potencialmente tetradimensional, con cuatro factores que explican una proporción significativa de la varianza común.
```
paran::paran(na.omit(MB), iterations = 5000,centile = 95,cfa = T)
#El análisis paralelo de Horn indicó la retención de cuatro factores, ya que los valores propios ajustados (λ > 0) fueron positivos hasta el cuarto componente. Esto sugiere que el instrumento presenta una estructura potencialmente tetradimensional, con cuatro factores que explican una proporción significativa de la varianza común.
